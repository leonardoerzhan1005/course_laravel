#!/bin/bash

echo "üå± –ó–∞–ø—É—Å–∫ —Å–∏–¥–µ—Ä–æ–≤ –¥–ª—è LMS —Å–∏—Å—Ç–µ–º—ã"
echo "=================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ Laravel –ø—Ä–æ–µ–∫—Ç–µ
if [ ! -f "artisan" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: artisan —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ Laravel –ø—Ä–æ–µ–∫—Ç–∞."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ composer —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
if ! command -v composer &> /dev/null; then
    echo "‚ùå –û—à–∏–±–∫–∞: composer –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ composer –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ PHP —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
if ! command -v php &> /dev/null; then
    echo "‚ùå –û—à–∏–±–∫–∞: PHP –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PHP –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    exit 1
fi

echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ"
echo ""

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
if [ ! -d "vendor" ]; then
    echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Composer..."
    composer install
    echo ""
fi

# –û—á–∏—â–∞–µ–º –∫—ç—à
echo "üßπ –û—á–∏—â–∞–µ–º –∫—ç—à..."
php artisan cache:clear
php artisan config:clear
php artisan view:clear
echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
echo "üóÑÔ∏è  –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö..."
php artisan migrate:fresh --seed --force
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç..."
php artisan seeders:check

echo ""
echo "üéâ –ì–æ—Ç–æ–≤–æ! –°–∏–¥–µ—Ä—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω—ã."
echo ""
echo "üìã –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:"
echo "  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å: php artisan seeders:check"
echo "  - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å: php artisan migrate:fresh --seed"
echo "  - –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à: php artisan cache:clear"
echo ""
echo "üë§ –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:"
echo "  - –ê–¥–º–∏–Ω: admin@gmail.com / 1234"
echo "  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ivan.petrov@example.com / password"
